# 存在问题

## 关于ADC的问题

- Invalid Pin for ADC
TODO 查阅文档 需要修改固件 (成本比较高, 而且浪费资源)
IO2 -> ADC2 Channel 2
TODO 改固件 从而可以支持ADC2
临时方案 底板Uno(A0) - 接Uno(A2) = ESP32 GPIO35
BUG 电压取值adc采样 不稳 一直在浮动 

多次采样然后平均
与标准电压比对 (5v 3v) * 系数

## [已解决] IRQ外部中断

MicroPython-ESP32中, irq 只有上升沿或下降沿 (二选1)

>TODO 修改固件, 添加Change模式. 

**而且这里需要的应该是-非阻塞(no-blocking)模式**


**查看ESP-IDF是否有这个API**
是否有必要使用外部中断, 可以使用定时器, 定时查看IO电平是否变化
https://github.com/BramRausch/encoderLib


ESP32 是否有硬件计数?


## [已解决]增量式编码器使用
编码器噪声问题 不是完全按照 0132的顺序来的。

两个引脚都是中断。

TODO 寻找项目参考
添加滤波器

1. 比对 可以大于等于两个？
2. 二者相等的情景？ 
3. 添加状态机 State (之前一直在正转 马上反转的可能性不大。)
4. 是否引入变量： 触发中断的管脚

**增量式编码器**
https://blog.csdn.net/cuhkljt/article/details/25845217
https://item.taobao.com/item.htm?spm=a230r.1.14.27.63de2886VbW8iL&id=45347924687&ns=1&abbucket=6#detail


**ESP32的IRQ是软件中断，相应速度不够， 改用定时器问题就解决了**


## 刷固件

刷固件， 需要把ESP32开发板从底板下取下。
> 有时需要有时不需要

## 声明引脚输入输出是个好习惯
Pin.IN
Pin.OUT

## [Done]电机引脚问题

Problem 左侧电机一动，reboot -> 更换引脚已解决 （因为用了D2接口）


## [Done]电机只能反转不能正转？
电机驱动模块插反
**电机驱动模块有正反**

## Flash损坏，不稳定

ERRORS
----main.py文件损毁？---
rst:0x1 (POWERON_RESET),boot:0x33 (SPI_FAST_FLASH_BOOT)
flash read err, 1000
ets_main.c 371 
ets Jun  8 2016 00:22:57


## [Done 1/2]定时器中断-连不上 传不了文件

main.py里面设定了定时器中断，导致不能通过ampy传文件，只能重置固件。

**ESP32的固件存放在RAM， 文件系统放置在ROM里面, 也就是说，重新刷固件并不会修改文件系统中的代码。**

如果程序里面一直在循环while True，repl资源一直被占用，无法写入程序。
所以需要链接repl，然后将main.py写为空，reboot一下，就解决了。

```python
f = open('main.py', 'w')
f.write('')
f.save
```


在`main.py`里面如果是定时器，定时器一直Print， 这个是个 **死结**
> 这种情况要如何处理？

这个问题可以预防，设置一个外部按键, 然后将main.py清空  write('')
> 修改固件 修改boot.py (留一手)

## 重置MicroPython-ESP32的文件系统

